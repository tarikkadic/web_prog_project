<!DOCTYPE html>
<html lang="zxx">
  <head>
    <!-- Required meta tags -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>News Now</title>
    <!-- plugin css for this page -->
    <link
      rel="stylesheet"
      href="./vendors/mdi/css/materialdesignicons.min.css"
    />
    <link rel="stylesheet" href="./vendors/aos/dist/aos.css/aos.css" />

    <!-- End plugin css for this page -->
    <link rel="shortcut icon" href="./assets/images/favicon.png" />

    <link rel="stylesheet" href="./assets/css/jQuerySPApp.css">

    <!-- inject:css -->
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./assets/css/forms.css">

    <!-- endinject -->
  </head>

  <body style="display:none;">
    <div class="container-scroller">
      <div class="main-panel">
        <!-- partial:partials/_navbar.html -->
        <header id="header">
          <div class="container">
            <nav class="navbar navbar-expand-lg navbar-light">
              <div class="navbar-top">
                <div class="d-flex justify-content-between align-items-center">


                </div>
              </div>
              <div class="navbar-bottom">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <a class="navbar-brand" href="#"
                      ><img style="max-width: 130px;" src="assets/images/logo.png" alt=""
                    ></a>
                  </div>
                  <div>
                    <button
                      class="navbar-toggler"
                      type="button"
                      data-target="#navbarSupportedContent"
                      aria-controls="navbarSupportedContent"
                      aria-expanded="false"
                      aria-label="Toggle navigation"
                    >
                      <span class="navbar-toggler-icon"></span>
                    </button>
                    <div
                      class="navbar-collapse justify-content-center collapse"
                      id="navbarSupportedContent"
                    >
                      <ul
                        class="navbar-nav d-lg-flex justify-content-between align-items-center"
                      >

                        <li class="nav-item active">
                          <a class="nav-link" href="#home">Home</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#covid19">COVID-19</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#business">Business</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#sports">Sports</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#art">Art</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#politics">POLITICS</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#travel">Travel</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#contact">Contact</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </nav>

            <main id="jqueryspapp" role="main">
             <section id="home" data-load="home.html"></section>
             <section id="covid-19" data-load="covid19.html"></section>
             <section id="business" data-load="business.html"></section>
             <section id="sports" data-load="sports.html"></section>
             <section id="art" data-load="art.html"></section>
           </main>

          </div>
        </header>



      <form id="login-form" style="margin-top: 150px;" class="box" action="index.html" method="post">
      <h1>Log In</h1>
      <input type="text" name="email" placeholder="Email" required>
      <input type="password" name="password" placeholder="Password" minlength="6" required>
      <button id="login_link" type="button" name="submit" onclick="doLogin();">Log In</button>
      <button style="font-size: 12px;" type="button" name="submit" onclick="showForgotForm();">Forgot password</button>
      <p>Don't have an account?</p>
      <button type="button" name="Register" onclick="window.location.href='register.html'">Register</button>
    </form>


    <form id="forgot-form" style="margin-top: 100px; display:none;" class="box" action="index.html" method="post">
    <input id="forgot-email" type="text" name="email" placeholder="Email" required>
    <button id="forgot_link" type="button" name="submit" onclick="doForgotPassword();">Send Conformation Link</button>
    <button id="forgot_link" type="button" name="submit" onclick="hideForgotForm();">Back to login</button>
  </form>

  <form id="change-password-form" style="margin-top: 100px; display:none;" class="box" action="index.html" method="post">
  <input id="change-password-token" type="hidden" name="token">
  <input id="change-password" type="password" name="password" placeholder="Password" required>
  <button id="forgot_link" type="button" name="submit" onclick="doChangePassword();">Change Password</button>
</form>

        <!-- main-panel ends -->
        <!-- container-scroller ends -->

        <!-- partial:partials/_footer.html -->


        <!-- partial -->
      </div>
    </div>
    <!-- inject:js -->
    <script src="./assets/js/jquery.min.js"></script>
    <script src="./assets/js/utils.js"></script>
    <script src="./assets/js/restClient.js"></script>
    <script src="./assets/js/jquery-3.6.0.min.js"></script>
    <script src="./vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- plugin js for this page -->
    <script src="./assets/js/utils.js"></script>
    <script src="./vendors/aos/dist/aos.js/aos.js"></script>
    <!-- End plugin js for this page -->
    <!-- Custom js for this page-->

    <script src="./assets/js/demo.js"></script>


    <script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <!-- End custom js for this page-->

    <script src="./assets/js/jQuerySPApp.js"></script>



    <script type="text/javascript">

      $(function(){
        if(window.localStorage.getItem("token")){
          window.location = "index.html";
        } else{
          $('body').show();
        }
        var urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('token')){
          $('#change-password-token').val(urlParams.get('token'));
          showChangePasswordForm();
        }
      });

        function doLogin(){

          $("#login_link").prop('disabled', true);
          $.post("api/login", jsonize_form('#login-form')).done(function( data ){
            window.localStorage.setItem("token", data.token);
            window.location = "index.html";
          }).fail(function(error){
            $("#login_link").prop('disabled', false);
            toastr.error(error.responseJSON.message);
          });

          console.log(login_info);
        }

        function showForgotForm(){
          $('#login-form').hide();
          $('#forgot-form').show();
        }

        function showChangePasswordForm(){
          $('#login-form').hide();
          $('#forgot-form').hide();
          $('#change-password-form').show();
        }

        function hideForgotForm(){
          $('#forgot-form').hide();
          $('#login-form').show();
        }

        function doForgotPassword(){
          $("#forgot-link").prop('disabled', true);
          $.post("api/forgot", jsonize_form('#forgot-form')).done(function( data ){
            console.log(data);
            $('#forgot-form').hide();
            $('#change-password-form').show();
          }).fail(function(error){
            $("#forgot-link").prop('disabled', false);
            toastr.error(error.responseJSON.message);
        });
      }

        function doChangePassword(){
          $("#forgot_link").prop('disabled', true);
          $.post("api/reset", jsonize_form('#change-password-form')).done(function( data ){
            window.localStorage.setItem("token", data.token);
            window.location = "index.html";
          }).fail(function(error){
            $("#forgot_link").prop('disabled', false);
            toastr.error(error.responseJSON.message);
            });
      }

    </script>

  </body>
</html>
